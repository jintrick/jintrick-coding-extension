---
id: v1.6.0
status: drafting
created: 2026-02-17
fixed_commit: 
---

# Issue: Windows 非ブロッキング対応とマニフェストの Hooks 定義削除

## 概要
Windows 環境における自動表示フック (`open_file_hook.cjs`) の非ブロッキング化を完成させ、ドキュメントに反して `gemini-extension.json` に記述された不要な `hooks` フィールドを削除する。

## 現状の課題
1.  **Windows での待機**: `spawn('code', ...)` では `code.cmd` が親プロセスを引き摺り、エージェントの待機が発生する場合がある。
2.  **マニフェストの誤記**: `gemini-extension.json` に `hooks` 配列が記述されているが、公式ドキュメントでは `hooks/hooks.json` を使用すべきと明記されており、二重管理かつ無効な記述となっている。

## 解決策
1.  **`start` コマンドの採用**:
    - `open_file_hook.cjs` 内で OS を判別。
    - Windows (`win32`) の場合、`cmd /c start "" code "${filePath}"` を実行し、プロセスを完全に切り離す。
2.  **マニフェストのクリーンアップ**:
    - `gemini-extension.json` から `hooks` フィールドを削除する。

## 実装詳細
- `hooks/scripts/open_file_hook.cjs`: `process.platform` による分岐を追加。
- `gemini-extension.json`: `hooks` 配列を削除。

## ゴール
- [ ] Windows 環境でファイル作成直後、VSCode が開き、かつエージェントが即座に次の動作を開始する。
- [ ] `gemini-extension.json` がクリーンになり、`hooks/hooks.json` のみがフック定義として機能する。
- [ ] CLI 再起動後もフックが正常に動作する。
