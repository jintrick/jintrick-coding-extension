id: v1.12.0
type: feature
status: drafting
created: 2026-02-20
---

# Issue: マニフェスト自動検証ツールの導入と開発フローのガードレール強化

## 概要
新機能（Agent, Command, Skill）の登録漏れや `dist/` 構造の誤認といった人為的ミスを「仕組み」で防ぐため、自動バリデータとドキュメントの強化を行う。

## 背景と問題点
- `v1.11.1` において、新規 Agent の `gemini-extension.json` への登録漏れが発生した。
- エージェントが配布資産（ルート）とビルド資産（`dist/`）の境界を正しく理解しておらず、不適切なビルドスクリプトの修正を試みた。
- 現在の IDD テンプレートにマニフェスト更新の確認項目が不足している。

## 解決策
### 1. 自動検証ツール (`tools/validate-manifest.cjs`) の実装
- `agents/` 下の `.md` が `gemini-extension.json` に登録されているかチェック。
- `commands/` 下の `.toml` が `gemini-extension.json` に登録されているかチェック。
- 登録されているファイルの実在確認。
- このスクリプトを `npm run build` または `npm test` の前段に組み込む。

### 2. 開発ガイド (`docs/reference/development-guide.md`) の更新
- 「配布資産」と「ビルド資産」の明確な定義を追記。
- `dist/` には `hooks` のみが含まれるべき理由を明文化。
- リリース前チェックリストの追加。

### 3. IDD テンプレート (`docs/issue/TEMPLATE.md`) の更新
- 「マニフェスト（`gemini-extension.json`）の更新が必要か？」というチェック項目を必須項目として追加。

## 実装内容詳細
- `tools/validate-manifest.cjs` の新規作成。
- `package.json` の `scripts` への統合。
- `docs/reference/development-guide.md` への「Architecture: Distribution vs Build Assets」セクションの追加。
- `docs/issue/TEMPLATE.md` への項目追加。

## ゴール
- 登録漏れがある状態で `npm run build` または `npm test` を実行するとエラーで停止すること。
- 次回以降のエージェントが、ドキュメントを参照することで `dist/` の役割を正しく理解できること。
- 設計段階でマニフェストの更新を意識せざるを得ないフローにすること。

## テスト戦略
- 意図的にファイルを未登録のままバリデータを作動させ、エラーが出ることを確認。
- 修正後にバリデータがパスすることを確認。
