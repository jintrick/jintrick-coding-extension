# Code Review Guide: jintrick-coding-extension

本プロジェクトのレビューでは、エージェントによる「自動生成・自動修正」が安全かつ確実に機能することを最優先とする。
レビュアー（およびサブエージェント）は、以下の基準に基づき、厳格かつ批判的にコードを評価せよ。

## Headless Architecture への準拠 (最優先)
- 環境非依存性: isTTY や特定のターミナル機能に依存したロジックを排除しているか。
- 自動化の阻害禁止: ユーザーの入力を待機する処理（readline や stdin 読み取り）が含まれていないか。
- 例外: md.cjs のような Human Linter は、CI=true の場合に即座に valid を返す等のフォールバックがあるか。
- 副作用の局所化: Hook や Skill が外部環境（環境変数、グローバル設定）を破壊的に変更していないか。

## 構文と実行の安全性
- 構文エラーの徹底排除: Linter Hook 自体が構文エラーで落ちることは「死」を意味する。
- 新しい Linter の追加時、acorn や typescript などのパーサが正しく設定されているか。
- リグレッション防止: 修正が既存の言語サポート（JS/TS/JSON/MD）を壊していないか。
- エラーハンドリング: パース失敗やファイル欠落時に allow（安全側に倒す）か deny（危険を止める）かが意図通りか。

## IDD (Issue-Driven Development) プロセスの遵守
- Issue 駆動: 変更は必ず承認済みの Issue 文書（docs/issue/vX.Y.Z.md）に基づいているか。
- ビルドの明示: dist/ 成果物が npm run build によって更新されており、ソースコードとの整合性が保たれているか。
- バージョン同期: package.json と gemini-extension.json のバージョンが sync-version.cjs によって同期されているか。

## パフォーマンスとトークン効率
- 低遅延 Hook: ツール実行ごとに呼ばれる Hook は極めて高速である必要がある。不要なディスク I/O や重い処理が含まれていないか。
- サブエージェント設計: サブエージェントのプロンプトは、プロジェクトに依存しない「汎用的エンジン」として設計されているか。

## シェルコマンドと環境の安全性
- 禁止演算子の回避: シェルコマンドで && を使用していないか（セミコロンまたは個別実行を徹底）。
- パス解決: path.join や __dirname を使用し、Windows/UNIX 両環境で動作するよう考慮されているか。
- 依存関係のバンドル: 新しいライブラリを追加した場合、esbuild のビルド対象に含まれているか。

---
レビュー時には必ずこの規約を @code-reviewer に渡し、上記基準に照らし合わせた指摘を求めよ。
