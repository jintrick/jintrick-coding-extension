---
id: v1.20.0
type: feat
status: done
created: 2026-02-26
fixed_commit: 
---

# Issue: MS ACCESS データベース操作スキルの追加

## 概要
MS ACCESS データベース (.accdb, .mdb) を操作するための専門スキルを追加し、Gemini CLI から SQL の実行やデータ抽出を可能にする。

## 背景と問題点
現在、Gemini CLI はローカルの MS ACCESS データベースを直接操作する手段を持っていない。業務自動化において ACCESS 内のデータ参照や更新が必要なケースがあり、これを自動化することで生産性を向上させる。

## 解決策
- 技術スタックとして `node-adodb` を採用し、ACCESS データベースとの接続を実現する。
- `skills/access-db` ディレクトリを新規作成し、SQL 実行用のスクリプトと `SKILL.md` を配備する。
- 読み取り（SELECT）および書き込み（INSERT/UPDATE/DELETE）の両方に対応する。

## 実装内容詳細
1.  `skills/access-db/SKILL.md` の作成:
    - `node-adodb` の使用方法と、ADODB 接続文字列の構築方法を記述。
    - ユーザーに `Provider` のインストール状況を確認させる手順を含める。
2.  `skills/access-db/scripts/db_client.cjs` の作成:
    - データベースパス、SQL 文、パスワード（オプション）を受け取り、結果を JSON 形式で返すユーティリティ。
    - Windows 環境における `Provider` の制約（32bit/64bit）に関するエラーハンドリング。
3.  `package.json` への依存関係追加は不要（スキル内スクリプトとして完結させるか、必要ならグローバルインストールを促す）。
4.  ビルド設定:
    - `npm run build` により `skills/` ディレクトリの内容が適切に配布用パッケージに含まれることを確認する。
5.  テスト戦略:
    - `tests/skills/access-db.test.js` を作成し、Vitest を使用して `db_client.cjs` の引数パースや接続文字列生成ロジックをテストする。
    - 実際のデータベース接続（DBエンジンへの依存）については、Windows 環境下での手動テスト（またはモック）により検証する。

## ゴール
- `skills/access-db` を使用して、指定した `.accdb` ファイルに対して SQL を実行し、結果を取得できる。
- 実行エラー発生時に、適切なトラブルシューティング情報をユーザーに提示できる。
- `npm test` で追加したテストがパスすること。
- `npm run build` 後に、ビルド成果物が正しく動作することを検証済みであること。
