---
id: v1.6.1
type: fix
status: completed
created: 2026-02-17
fixed_commit: eeff5bf 
---

# Issue: Windows における cmd.exe 大量発生問題の修正

## 概要
`v1.5.4` で実装した `hooks/scripts/linters/md.cjs` 内の `spawn('cmd', ['/c', 'start', ...])` が原因で、Windows 環境においてファイル保存のたびに cmd.exe プロセス（ウィンドウ）が残留・大量発生する問題を修正する。

## 原因
明示的に `cmd /c start` を呼び出すことで、非同期実行を意図したが、Windows のシェル挙動により各プロセスが適切に終了せず、ウィンドウとして残ってしまっている。

## 解決策
- `cmd` を明示的に呼び出すのをやめる。
- 代わりに `spawn('code', [filePath], { shell: true, detached: true, stdio: 'ignore' })` を使用する。
- `shell: true` により、Windows では自動的に適切なシェル経由で実行され、かつ `detached: true` によりエージェントから切り離される。

## 実装内容詳細
- `hooks/scripts/linters/md.cjs` の Windows 向け分岐ロジックを簡素化し、`shell: true` を利用する形に統一する。

## ゴール
- [ ] Windows 環境でファイル保存時、cmd.exe のウィンドウが残留せず、VSCode のみが静かに起動する。
